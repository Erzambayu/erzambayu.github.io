<!-- Contact Form Component -->
<div class="contact-form-section" id="contact-form">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        
        <!-- Form Header -->
        <div class="form-header text-center mb-5" data-aos="fade-up">
          <h2 class="form-title" data-translate="contact.form.title">Mari Diskusi Proyek Anda!</h2>
          <p class="form-subtitle" data-translate="contact.form.subtitle">
            Ceritakan ide atau kebutuhan proyek Anda. Saya siap membantu mewujudkannya dengan solusi teknologi yang tepat.
          </p>
        </div>

        <!-- Contact Form -->
        <form id="contact-form" class="contact-form" data-aos="fade-up" data-aos-delay="200">
          
          <!-- Form Row 1: Name & Email -->
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="contact-name" class="form-label" data-translate="form.name">Nama Lengkap</label>
                <div class="input-wrapper">
                  <i class="fas fa-user input-icon"></i>
                  <input type="text" 
                         id="contact-name" 
                         name="name" 
                         class="form-control" 
                         required
                         data-translate-placeholder="form.name_placeholder"
                         placeholder="Masukkan nama lengkap Anda">
                  <div class="input-feedback"></div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="contact-email" class="form-label" data-translate="form.email">Email</label>
                <div class="input-wrapper">
                  <i class="fas fa-envelope input-icon"></i>
                  <input type="email" 
                         id="contact-email" 
                         name="email" 
                         class="form-control" 
                         required
                         data-translate-placeholder="form.email_placeholder"
                         placeholder="nama@email.com">
                  <div class="input-feedback"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Form Row 2: Subject -->
          <div class="row">
            <div class="col-12">
              <div class="form-group">
                <label for="contact-subject" class="form-label" data-translate="form.subject">Subjek</label>
                <div class="input-wrapper">
                  <i class="fas fa-tag input-icon"></i>
                  <select id="contact-subject" name="subject" class="form-control" required>
                    <option value="" data-translate="form.subject_placeholder">Pilih kategori proyek...</option>
                    <option value="web-development" data-translate="form.subjects.web_dev">Web Development</option>
                    <option value="security-research" data-translate="form.subjects.security">Security Research</option>
                    <option value="network-engineering" data-translate="form.subjects.network">Network Engineering</option>
                    <option value="consultation" data-translate="form.subjects.consultation">Konsultasi IT</option>
                    <option value="collaboration" data-translate="form.subjects.collaboration">Kolaborasi</option>
                    <option value="other" data-translate="form.subjects.other">Lainnya</option>
                  </select>
                  <div class="input-feedback"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Form Row 3: Budget Range -->
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="contact-budget" class="form-label" data-translate="form.budget">Budget Range</label>
                <div class="input-wrapper">
                  <i class="fas fa-dollar-sign input-icon"></i>
                  <select id="contact-budget" name="budget" class="form-control">
                    <option value="" data-translate="form.budget_placeholder">Pilih budget range (opsional)...</option>
                    <option value="under-5m">< Rp 5 Juta</option>
                    <option value="5m-15m">Rp 5 - 15 Juta</option>
                    <option value="15m-50m">Rp 15 - 50 Juta</option>
                    <option value="over-50m">> Rp 50 Juta</option>
                    <option value="discuss" data-translate="form.budget_discuss">Mari Diskusikan</option>
                  </select>
                  <div class="input-feedback"></div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="contact-timeline" class="form-label" data-translate="form.timeline">Timeline</label>
                <div class="input-wrapper">
                  <i class="fas fa-calendar-alt input-icon"></i>
                  <select id="contact-timeline" name="timeline" class="form-control">
                    <option value="" data-translate="form.timeline_placeholder">Pilih timeline (opsional)...</option>
                    <option value="asap" data-translate="form.timeline_asap">Segera (< 1 bulan)</option>
                    <option value="1-3months" data-translate="form.timeline_1_3">1-3 Bulan</option>
                    <option value="3-6months" data-translate="form.timeline_3_6">3-6 Bulan</option>
                    <option value="flexible" data-translate="form.timeline_flexible">Fleksibel</option>
                  </select>
                  <div class="input-feedback"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Form Row 4: Message -->
          <div class="row">
            <div class="col-12">
              <div class="form-group">
                <label for="contact-message" class="form-label" data-translate="form.message">Pesan</label>
                <div class="input-wrapper">
                  <i class="fas fa-comment input-icon"></i>
                  <textarea id="contact-message" 
                           name="message" 
                           class="form-control" 
                           rows="5" 
                           required
                           data-translate-placeholder="form.message_placeholder"
                           placeholder="Ceritakan detail proyek, kebutuhan spesifik, atau pertanyaan Anda..."></textarea>
                  <div class="input-feedback"></div>
                  <div class="character-count">
                    <span id="char-count">0</span>/500 karakter
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Honey Pot (Anti-spam) -->
          <input type="text" name="honeypot" style="display: none;" tabindex="-1" autocomplete="off">

          <!-- Submit Button -->
          <div class="form-actions text-center">
            <button type="submit" class="btn-submit" id="submit-btn">
              <i class="fas fa-paper-plane btn-icon"></i>
              <span class="btn-text" data-translate="form.submit">Kirim Pesan</span>
              <div class="btn-loader"></div>
            </button>
            <p class="form-note" data-translate="form.response_time">
              Biasanya saya merespons dalam 24 jam. Untuk urusan mendesak, hubungi langsung via WhatsApp.
            </p>
          </div>

          <!-- Form Status -->
          <div id="form-status" class="form-status"></div>

        </form>

        <!-- Contact Alternative -->
        <div class="contact-alternative text-center mt-5" data-aos="fade-up" data-aos-delay="400">
          <p class="alternative-text" data-translate="contact.alternative">
            Atau hubungi saya langsung melalui:
          </p>
          <div class="alternative-links">
            <a href="https://wa.me/6285156545003" target="_blank" class="alternative-link whatsapp">
              <i class="fab fa-whatsapp"></i>
              <span>WhatsApp</span>
            </a>
            <a href="mailto:erzambayu@gmail.com" class="alternative-link email">
              <i class="fas fa-envelope"></i>
              <span>Email</span>
            </a>
            <a href="https://t.me/erzambayu" target="_blank" class="alternative-link telegram">
              <i class="fab fa-telegram"></i>
              <span>Telegram</span>
            </a>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- Contact Form JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('contact-form');
  const submitBtn = document.getElementById('submit-btn');
  const formStatus = document.getElementById('form-status');
  const messageTextarea = document.getElementById('contact-message');
  const charCount = document.getElementById('char-count');
  
  // Character counter
  messageTextarea.addEventListener('input', function() {
    const count = this.value.length;
    charCount.textContent = count;
    
    if (count > 500) {
      charCount.style.color = '#ef4444';
    } else if (count > 400) {
      charCount.style.color = '#f59e0b';
    } else {
      charCount.style.color = 'var(--text-muted)';
    }
  });

  // Real-time validation
  const inputs = form.querySelectorAll('input, select, textarea');
  inputs.forEach(input => {
    input.addEventListener('blur', validateField);
    input.addEventListener('input', clearValidation);
  });

  function validateField(e) {
    const field = e.target;
    const wrapper = field.closest('.input-wrapper');
    const feedback = wrapper.querySelector('.input-feedback');
    
    // Clear previous validation
    wrapper.classList.remove('error', 'success');
    feedback.textContent = '';
    
    // Skip validation for optional fields
    if (!field.required && !field.value.trim()) return;
    
    let isValid = true;
    let message = '';
    
    // Required field validation
    if (field.required && !field.value.trim()) {
      isValid = false;
      message = field.name === 'name' ? 'Nama wajib diisi' :
                field.name === 'email' ? 'Email wajib diisi' :
                field.name === 'subject' ? 'Pilih kategori proyek' :
                field.name === 'message' ? 'Pesan wajib diisi' : 'Field ini wajib diisi';
    }
    
    // Email validation
    else if (field.type === 'email' && field.value.trim()) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(field.value)) {
        isValid = false;
        message = 'Format email tidak valid';
      }
    }
    
    // Name validation
    else if (field.name === 'name' && field.value.trim()) {
      if (field.value.trim().length < 2) {
        isValid = false;
        message = 'Nama minimal 2 karakter';
      } else if (!/^[a-zA-Z\s]+$/.test(field.value)) {
        isValid = false;
        message = 'Nama hanya boleh berisi huruf dan spasi';
      }
    }
    
    // Message validation
    else if (field.name === 'message' && field.value.trim()) {
      if (field.value.trim().length < 10) {
        isValid = false;
        message = 'Pesan minimal 10 karakter';
      } else if (field.value.length > 500) {
        isValid = false;
        message = 'Pesan maksimal 500 karakter';
      }
    }
    
    // Update UI
    wrapper.classList.add(isValid ? 'success' : 'error');
    feedback.textContent = message;
    
    return isValid;
  }
  
  function clearValidation(e) {
    const wrapper = e.target.closest('.input-wrapper');
    wrapper.classList.remove('error');
  }

  // Form submission
  form.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Validate all fields
    let isFormValid = true;
    inputs.forEach(input => {
      if (!validateField({ target: input })) {
        isFormValid = false;
      }
    });
    
    if (!isFormValid) {
      showStatus('error', 'Mohon perbaiki kesalahan pada form');
      return;
    }
    
    // Check honeypot
    if (form.honeypot.value) {
      showStatus('error', 'Spam terdeteksi');
      return;
    }
    
    // Show loading state
    setSubmitState('loading');
    
    try {
      // Collect form data
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      
      // Send to backend (using Formspree as example)
      const response = await fetch('https://formspree.io/f/erzambayu@gmail.com', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          name: data.name,
          email: data.email,
          subject: data.subject,
          budget: data.budget,
          timeline: data.timeline,
          message: data.message,
          _subject: `Pesan baru dari ${data.name} - ${data.subject}`,
          _replyto: data.email
        })
      });
      
      if (response.ok) {
        setSubmitState('success');
        showStatus('success', 'Pesan berhasil dikirim! Saya akan segera menghubungi Anda.');
        form.reset();
        charCount.textContent = '0';
        
        // Clear all validations
        inputs.forEach(input => {
          const wrapper = input.closest('.input-wrapper');
          wrapper.classList.remove('error', 'success');
          wrapper.querySelector('.input-feedback').textContent = '';
        });
        
      } else {
        throw new Error('Failed to send message');
      }
      
    } catch (error) {
      console.error('Form submission error:', error);
      setSubmitState('error');
      showStatus('error', 'Gagal mengirim pesan. Silakan coba lagi atau hubungi langsung via WhatsApp.');
    }
  });
  
  function setSubmitState(state) {
    const btnIcon = submitBtn.querySelector('.btn-icon');
    const btnText = submitBtn.querySelector('.btn-text');
    const btnLoader = submitBtn.querySelector('.btn-loader');
    
    submitBtn.classList.remove('loading', 'success', 'error');
    
    switch(state) {
      case 'loading':
        submitBtn.classList.add('loading');
        submitBtn.disabled = true;
        btnIcon.style.display = 'none';
        btnLoader.style.display = 'block';
        btnText.textContent = 'Mengirim...';
        break;
        
      case 'success':
        submitBtn.classList.add('success');
        submitBtn.disabled = false;
        btnIcon.className = 'fas fa-check btn-icon';
        btnIcon.style.display = 'inline';
        btnLoader.style.display = 'none';
        btnText.textContent = 'Terkirim!';
        
        setTimeout(() => {
          btnIcon.className = 'fas fa-paper-plane btn-icon';
          btnText.textContent = 'Kirim Pesan';
          submitBtn.classList.remove('success');
        }, 3000);
        break;
        
      case 'error':
        submitBtn.classList.add('error');
        submitBtn.disabled = false;
        btnIcon.className = 'fas fa-exclamation-triangle btn-icon';
        btnIcon.style.display = 'inline';
        btnLoader.style.display = 'none';
        btnText.textContent = 'Gagal Kirim';
        
        setTimeout(() => {
          btnIcon.className = 'fas fa-paper-plane btn-icon';
          btnText.textContent = 'Kirim Pesan';
          submitBtn.classList.remove('error');
        }, 3000);
        break;
        
      default:
        submitBtn.disabled = false;
        btnIcon.style.display = 'inline';
        btnLoader.style.display = 'none';
    }
  }
  
  function showStatus(type, message) {
    formStatus.className = `form-status ${type}`;
    formStatus.innerHTML = `
      <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
      ${message}
    `;
    formStatus.style.display = 'block';
    
    setTimeout(() => {
      formStatus.style.display = 'none';
    }, 5000);
  }
});
</script>